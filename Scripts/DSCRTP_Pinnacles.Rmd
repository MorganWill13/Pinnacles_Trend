---
title: "DSCRTP_Pinnacles"
author: "Morgan Will"
date: "4/5/2022"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(vegan)
library(dummies)
library(maps)
library(sp)
library(maptools)
library(rgdal)
library(lattice)
library(classInt)
library(raster)
```

```{r}
#DSCRTP data clipped to Pinnacles region and filtered by genus in ArcGIS. Imported here:
Muricea <- read.csv("../Data/Pinnacles_Muricea_Final.csv")
View(Muricea)
Swiftia <- read.csv("../Data/Pinnacles_Swiftia_Final.csv")
View(Swiftia)
Thesea <- read.csv("../Data/Pinnacles_Thesea_Final.csv")
View(Thesea)
```

```{r}
#Rasters of interest
Bathymetry <- raster(paste0("../Data/USGS_bathy_meso_raster/USGS_bathy_meso_raster.tif"))
Bathymetry <- setMinMax(Bathymetry)
Backscatter <- raster(paste0("../Data/USGS_backs_meso_raster/USGS_backs_meso_ras.tif"))
Backscatter <- setMinMax(Backscatter)
```

```{r}
#Muricea
plot(Muricea$latitude__degrees_north_,Muricea$longitude__degrees_east_)
#Form a data frame of muricea counts (OID_=site, IndividualCount=abundance) and envirmental data
Muricea_raw <- data.frame(Muricea$OID_, Muricea$IndividualCount)
Muricea_env <- data.frame(Muricea$DEPTH, Muricea$BACKSCATTER, Muricea$SLOPE, Muricea$ASPECT, Muricea$SST, Muricea$ObservationYear)
#Compare with rda
Muricea_rda = rda(Muricea_raw, Muricea_env)
plot(Muricea_rda)
anova(Muricea_rda)
#General Linear Model (Poisson)
Muricea_glm_poisson <- glm(IndividualCount ~ OID_ + DEPTH + BACKSCATTER + SLOPE + ASPECT + SST + ObservationYear, data=Muricea, family=poisson(link="log"))
summary(Muricea_glm_poisson)
plot(Muricea_glm_poisson)
```

```{r}
#Swiftia
plot(Swiftia$latitude__degrees_north_,Swiftia$longitude__degrees_east_)
#Form a data frame of swiftia counts (OID_=site, IndividualCount=abundance) and envirmental data
Swiftia_raw <- data.frame(Swiftia$OID_, Swiftia$IndividualCount)
Swiftia_env <- data.frame(Swiftia$DEPTH, Swiftia$BACKSCATTER, Swiftia$SLOPE, Swiftia$ASPECT, Swiftia$SST, Swiftia$ObservationYear)
#Compare with rda
Swiftia_rda = rda(Swiftia_raw, Swiftia_env)
plot(Swiftia_rda)
anova(Swiftia_rda)
#General Linear Model (Poisson)
Swiftia_glm <- glm(IndividualCount ~ OID_ + DEPTH + BACKSCATTER + SLOPE + ASPECT + SST + ObservationYear, data=Swiftia, family=poisson(link="log"))
summary(Swiftia_glm)
plot(Swiftia_glm)

```

```{r}
#Thesea
plot(Thesea$latitude__degrees_north_, Thesea$longitude__degrees_east_)
#Form a data frame of muricea counts (OID_=site, IndividualCount=abundance) and envirmental data
Thesea_raw <- data.frame(Thesea$OID_, Thesea$IndividualCount)
Thesea_env <- data.frame(Thesea$DEPTH, Thesea$BACKSCATTER, Thesea$SLOPE, Thesea$ASPECT, Thesea$SST, Thesea$ObservationYear)
#Compare with rda
Thesea_rda = rda(Thesea_raw, Thesea_env)
plot(Thesea_rda)
anova(Thesea_rda)
#General Linear Model (Poisson)
Thesea_glm <- glm(IndividualCount ~ OID_ + DEPTH + BACKSCATTER + SLOPE + ASPECT + SST + ObservationYear, data=Thesea, family=poisson(link="log"))
summary(Thesea_glm)
plot(Thesea_glm)
```
